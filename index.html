<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Newman Family Zoo – Episode Uploader</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <h1>Newman Family Zoo – Upload</h1>

    <!-- Password gate (simple front-end lock) -->
    <form id="auth-form">
      <label for="password">Password</label>
      <input type="password" id="password" />
      <button type="submit">Enter</button>
    </form>

    <!-- Upload form (hidden until password is correct) -->
    <form id="upload-form" class="hidden">
      <label>
        Episode Title
        <input type="text" name="title" required />
      </label>

      <label>
        Episode Description
        <textarea name="description" rows="4" required></textarea>
      </label>

      <label>
        Publish Date
        <input type="date" name="pubDate" required />
      </label>

      <label>
        Audio File (MP3 only)
        <input
          type="file"
          name="audio"
          accept="audio/mpeg,audio/mp3"
          required
        />
      </label>

      <button type="submit">Upload Episode</button>
    </form>

    <p id="status"></p>
  </div>

  <script>
    const authForm = document.getElementById("auth-form");
    const uploadForm = document.getElementById("upload-form");
    const statusEl = document.getElementById("status");

    // Change this to whatever password you want on the front-end
    const FRONTEND_PASSWORD = "NEWMANZOO2025";

    authForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const inputPw = document.getElementById("password").value.trim();
      if (inputPw === FRONTEND_PASSWORD) {
        authForm.classList.add("hidden");
        uploadForm.classList.remove("hidden");
      } else {
        alert("Incorrect password.");
      }
    });

    uploadForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "Uploading...";

      const formData = new FormData(uploadForm);

      try {
        const res = await fetch("/.netlify/functions/upload-episode", {
          method: "POST",
          body: formData,
        });
        const text = await res.text();
        statusEl.textContent = text;

        if (res.ok) {
          uploadForm.reset();
        }
      } catch (err) {
        statusEl.textContent = "Upload failed: " + err.message;
      }
    });
  </script>
</body>
</html>
